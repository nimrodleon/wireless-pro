<form class="row row-cols-auto g-2 mt-2 d-print-none">
  <div class="col-auto">
    <input type="number" [formControl]="averiaYearInput" class="form-control" placeholder="Year">
  </div>
  <div class="col-auto">
    <button type="button" (click)="averiaListLoad()" class="btn btn-primary">
      <i class="fas fa-sync"></i><span class="text-uppercase ms-1">Cargar</span>
    </button>
  </div>
  <div class="col-auto">
    <button (click)="addAveriaClick()" class="btn btn-success">
      <i class="fas fa-plus"></i>
      <span class="text-uppercase ms-1">Registrar Averia</span>
    </button>
  </div>
</form>
<div class="table-responsive">
  <table class="table table-striped">
    <thead>
    <tr class="text-uppercase">
      <th>Averia</th>
      <th></th>
      <th>Responsable</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let averia of averiaList">
      <td>
        <span class="d-block">{{averia.averia}}</span>
        <a [routerLink]="['/client/detail', currentClient._id]">
          {{currentClient.fullName}} - {{currentClient.phone}}
        </a>
        <!-- COMENTARIO -->
        <div class="card px-2" *ngIf="averia.solution">{{averia.solution}}</div>
        <div class="d-flex">
          <!-- ESTADO -->
          <span class="me-1">
                  <ng-container *ngIf="averia.status === 'P'">
                    <span class="badge bg-primary">PENDIENTE</span>
                  </ng-container>
                  <ng-container *ngIf="averia.status === 'E'">
                    <span class="badge bg-warning text-white">EN PROCESO</span>
                  </ng-container>
                  <ng-container *ngIf="averia.status === 'F'">
                    <span class="badge bg-success">FINALIZADO</span>
                  </ng-container>
                  </span>
          <!-- PRIORIDAD -->
          <span class="ms-1">
                  <ng-container *ngIf="averia.priority === 'A'">
                    <span class="badge bg-danger">ALTA</span>
                  </ng-container>
                  <ng-container *ngIf="averia.priority === 'B'">
                    <span class="badge bg-info">BAJA</span>
                  </ng-container>
                  <ng-container *ngIf="averia.priority === 'M'">
                    <span class="badge bg-warning text-white">MEDIA</span>
                  </ng-container>
                  </span>
        </div>
        <span class="blockquote-footer">{{averia.createdAt|date}}</span>
      </td>
      <td class="text-center">
        <button (click)="attendAveriaClick(averia._id)" class="btn btn-info btn-sm">
          <span class="text-uppercase">Atender</span>
        </button>
      </td>
      <td>
        <ng-container *ngIf="averia.user">
          <span class="text-uppercase">{{averia.user.fullName}}</span>
        </ng-container>
      </td>
      <td>
        <div class="btn-opt ms-auto">
          <button (click)="editAveriaClick(averia._id)" class="btn btn-secondary btn-sm me-2">
            <i class="fas fa-edit"></i></button>
          <button (click)="deleteAveriaClick(averia._id)" class="btn btn-danger btn-sm">
            <i class="fas fa-trash-alt"></i></button>
        </div>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<app-averia-modal
  [title]="titleAveria"
  [averia]="currentAveria"
  (sendModel)="saveChangeAveria($event)">
</app-averia-modal>
<app-averia-attend
  [averia]="currentAveria"
  (sendModel)="saveChangeAveria($event)">
</app-averia-attend>
